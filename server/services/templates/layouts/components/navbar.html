{{define "navbar"}}
<!-- High Fantasy Navigation Header -->
<style>
  /* Mystical Navbar Styles */
  .fantasy-navbar {
    background: rgba(15, 10, 30, 0.92);
    backdrop-filter: blur(12px);
    border-bottom: 2px solid rgba(103, 80, 164, 0.5);
    box-shadow: 0 4px 24px rgba(103, 80, 164, 0.3),
      0 0 40px rgba(103, 80, 164, 0.1);
    position: relative;
    z-index: 1000;
  }

  .fantasy-navbar::after {
    content: "";
    position: absolute;
    bottom: -2px;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(103, 80, 164, 0.8) 20%,
      rgba(138, 110, 220, 0.8) 50%,
      rgba(103, 80, 164, 0.8) 80%,
      transparent
    );
    box-shadow: 0 0 10px rgba(103, 80, 164, 0.5);
  }

  /* Brand */
  .fantasy-brand {
    font-family: "Cinzel", serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: #fff;
    text-shadow: 0 0 20px rgba(103, 80, 164, 0.8),
      0 0 10px rgba(138, 110, 220, 0.6);
    letter-spacing: 2px;
    transition: all 0.3s ease;
  }

  .fantasy-brand:hover {
    color: #8a6edc;
    text-shadow: 0 0 30px rgba(138, 110, 220, 1),
      0 0 15px rgba(103, 80, 164, 0.8);
  }

  .fantasy-brand i {
    filter: drop-shadow(0 0 10px rgba(103, 80, 164, 0.8));
  }

  /* Main Nav Items */
  .fantasy-nav-items {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  .fantasy-nav-link {
    font-family: "Cinzel", serif;
    font-size: 0.95rem; /* Slightly smaller font size */
    font-weight: 600;
    color: rgba(255, 255, 255, 0.85);
    text-decoration: none;
    padding: 0.5rem 1rem; /* Reduced padding */
    border-radius: 8px;
    border: 1px solid rgba(103, 80, 164, 0.3);
    background: rgba(103, 80, 164, 0.15);
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    letter-spacing: 1px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .fantasy-nav-link::before {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 250px; /* Adjusted radial gradient size */
    height: 250px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(138, 110, 220, 0.4), transparent);
    transition: all 0.5s ease;
    transform: translate(-50%, -50%);
  }

  .fantasy-nav-link:hover::before {
    width: 300px;
    height: 300px;
  }

  .fantasy-nav-link:hover {
    color: #fff;
    border-color: rgba(138, 110, 220, 0.8);
    background: rgba(103, 80, 164, 0.3);
    box-shadow: 0 0 20px rgba(103, 80, 164, 0.5),
      inset 0 0 20px rgba(138, 110, 220, 0.2);
    transform: translateY(-2px);
  }

  .fantasy-nav-link i {
    font-size: 1.2rem;
    transition: all 0.3s ease;
    position: relative;
    z-index: 1;
  }

  .fantasy-nav-link:hover i {
    transform: scale(1.2) rotate(5deg);
    filter: drop-shadow(0 0 8px rgba(138, 110, 220, 0.8));
  }

  .fantasy-nav-link span {
    position: relative;
    z-index: 1;
  }

  .fantasy-nav-link.active {
    background: rgba(103, 80, 164, 0.4);
    border-color: rgba(138, 110, 220, 0.9);
    box-shadow: 0 0 15px rgba(103, 80, 164, 0.6),
      inset 0 0 15px rgba(138, 110, 220, 0.3);
  }

  /* Locked nav item styles */
  .fantasy-nav-link.locked {
    color: rgba(255, 255, 255, 0.4);
    border-color: rgba(103, 80, 164, 0.2);
    background: rgba(103, 80, 164, 0.08);
    cursor: not-allowed;
    pointer-events: all;
    padding: 0.5rem 1rem; /* Reduced padding for locked state */
  }

  .fantasy-nav-link.locked:hover::before {
    width: 0;
    height: 0;
  }

  .fantasy-nav-link.locked:hover {
    color: rgba(255, 255, 255, 0.4);
    border-color: rgba(103, 80, 164, 0.2);
    background: rgba(103, 80, 164, 0.08);
    transform: none;
    box-shadow: none;
  }

  /* Golden glow pulse animation for Fishing */
  @keyframes golden-pulse {
    0%,
    100% {
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.4),
        inset 0 0 15px rgba(255, 215, 0, 0.1),
        0 4px 24px rgba(103, 80, 164, 0.3);
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
    }
    50% {
      box-shadow: 0 0 35px rgba(255, 215, 0, 0.8),
        inset 0 0 25px rgba(255, 215, 0, 0.2),
        0 4px 24px rgba(103, 80, 164, 0.3);
      text-shadow: 0 0 20px rgba(255, 215, 0, 1);
    }
  }

  /* Purple glow pulse animation for Dungeons */
  @keyframes purple-pulse {
    0%,
    100% {
      box-shadow: 0 0 15px rgba(186, 85, 211, 0.4),
        inset 0 0 15px rgba(186, 85, 211, 0.1),
        0 4px 24px rgba(103, 80, 164, 0.3);
      text-shadow: 0 0 10px rgba(186, 85, 211, 0.6);
    }
    50% {
      box-shadow: 0 0 35px rgba(186, 85, 211, 0.8),
        inset 0 0 25px rgba(186, 85, 211, 0.2),
        0 4px 24px rgba(103, 80, 164, 0.3);
      text-shadow: 0 0 20px rgba(186, 85, 211, 1);
    }
  }

  .fantasy-nav-link.unlocked-fishing {
    animation: golden-pulse 2.5s ease-in-out infinite;
    color: #ffd700;
    border-color: rgba(255, 215, 0, 0.6);
  }

  .fantasy-nav-link.unlocked-dungeons {
    animation: purple-pulse 2.5s ease-in-out infinite;
    color: #ba55d3;
    border-color: rgba(186, 85, 211, 0.6);
  }

  /* User Dropdown */
  .fantasy-user-btn {
    font-family: "Cinzel", serif;
    background: rgba(103, 80, 164, 0.2);
    border: 1px solid rgba(103, 80, 164, 0.5);
    color: rgba(255, 255, 255, 0.9);
    padding: 0.6rem 1.2rem;
    border-radius: 25px;
    transition: all 0.3s ease;
    box-shadow: 0 0 10px rgba(103, 80, 164, 0.3);
  }

  .fantasy-user-btn:hover {
    background: rgba(103, 80, 164, 0.4);
    border-color: rgba(138, 110, 220, 0.8);
    color: #fff;
    box-shadow: 0 0 20px rgba(103, 80, 164, 0.6);
    transform: translateY(-2px);
  }

  .fantasy-dropdown-menu {
    background: rgba(20, 15, 35, 0.95);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(103, 80, 164, 0.5);
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 0 20px rgba(103, 80, 164, 0.3);
    padding: 0.5rem 0;
  }

  .fantasy-dropdown-item {
    font-family: "Cinzel", serif;
    color: rgba(255, 255, 255, 0.85);
    padding: 0.6rem 1.5rem;
    transition: all 0.3s ease;
  }

  .fantasy-dropdown-item:hover {
    background: rgba(103, 80, 164, 0.3);
    color: #fff;
    box-shadow: inset 0 0 10px rgba(138, 110, 220, 0.2);
  }

  .fantasy-dropdown-item i {
    width: 20px;
    text-align: center;
  }

  .fantasy-dropdown-divider {
    border-color: rgba(103, 80, 164, 0.3);
    margin: 0.5rem 0;
  }

  /* Responsive */
  @media (max-width: 991px) {
    .fantasy-nav-items {
      display: none;
    }

    .fantasy-navbar .container-fluid {
      justify-content: space-between;
    }
  }

  @media (min-width: 992px) {
    .mobile-menu-toggle {
      display: none;
    }
  }
</style>

<nav class="navbar navbar-expand-lg fantasy-navbar">
  <div class="container-fluid px-4">
    <!-- Brand -->
    <a class="navbar-brand fantasy-brand d-flex align-items-center" href="/">
      <i class="fas fa-link me-2"></i>
      <span>PARALLAX</span>
    </a>

    <!-- Main Navigation Items (Left Side) -->
    <div class="fantasy-nav-items d-none d-lg-flex ms-4">
      <a href="/teams" class="fantasy-nav-link">
        <i class="fas fa-users"></i>
        <span>Teams</span>
      </a>
      <a href="/expeditions" class="fantasy-nav-link">
        <i class="fas fa-dungeon"></i>
        <span>Expeditions</span>
      </a>
      {{if .Data.NavbarState.HasFishingRod}}
      <a href="/fishing" class="fantasy-nav-link unlocked-fishing">
        <i class="fas fa-fish"></i>
        <span>Fishing</span>
      </a>
      {{else}}
      <button
        type="button"
        class="fantasy-nav-link locked"
        data-bs-toggle="popover"
        data-bs-placement="bottom"
        data-bs-title="Fishing Locked"
        data-bs-content="You need the Golden Fishing Rod to unlock Fishing. Obtain it from the Tutorial Rift."
        data-bs-trigger="hover"
      >
        <i class="fas fa-question-circle"></i>
        <span>Hidden</span>
      </button>
      {{end}} {{if .Data.NavbarState.HasCompass}}
      <a href="/dungeons" class="fantasy-nav-link unlocked-dungeons">
        <i class="fas fa-chess-rook"></i>
        <span>Dungeons</span>
      </a>
      {{else}}
      <button
        type="button"
        class="fantasy-nav-link locked"
        data-bs-toggle="popover"
        data-bs-placement="bottom"
        data-bs-title="Dungeons Locked"
        data-bs-content="You need the Explorers Compass to unlock Dungeons. Obtain it from the Tutorial Rift."
        data-bs-trigger="hover"
      >
        <i class="fas fa-question-circle"></i>
        <span>Hidden</span>
      </button>
      {{end}}
      <a href="/inventory" class="fantasy-nav-link">
        <i class="fas fa-briefcase"></i>
        <span>Inventory</span>
      </a>
    </div>

    <!-- Spacer -->
    <div class="flex-grow-1"></div>

    <!-- User Menu (Right Side) -->
    <div class="dropdown">
      <button
        class="btn fantasy-user-btn d-flex align-items-center"
        type="button"
        data-bs-toggle="dropdown"
      >
        <i class="fas fa-user-circle me-2"></i>
        <span class="d-none d-sm-inline">{{.Data.Username}}</span>
        <i class="fas fa-chevron-down ms-2 small"></i>
      </button>
      <ul class="dropdown-menu dropdown-menu-end fantasy-dropdown-menu">
        <!-- Mobile-only nav items -->
        <li class="d-lg-none">
          <a class="dropdown-item fantasy-dropdown-item" href="/teams">
            <i class="fas fa-users me-2"></i>Teams
          </a>
        </li>
        <li class="d-lg-none">
          <a class="dropdown-item fantasy-dropdown-item" href="/expeditions">
            <i class="fas fa-dungeon me-2"></i>Expeditions
          </a>
        </li>
        {{if .Data.NavbarState.HasFishingRod}}
        <li class="d-lg-none">
          <a class="dropdown-item fantasy-dropdown-item" href="/fishing">
            <i class="fas fa-fish me-2"></i>Fishing
          </a>
        </li>
        {{else}}
        <li class="d-lg-none">
          <a
            class="dropdown-item fantasy-dropdown-item"
            href="#"
            onclick="alert('You need the Golden Fishing Rod to unlock Fishing'); return false;"
          >
            <i class="fas fa-question-circle me-2"></i>Hidden
          </a>
        </li>
        {{end}} {{if .Data.NavbarState.HasCompass}}
        <li class="d-lg-none">
          <a class="dropdown-item fantasy-dropdown-item" href="/dungeons">
            <i class="fas fa-castle me-2"></i>Dungeons
          </a>
        </li>
        {{else}}
        <li class="d-lg-none">
          <a
            class="dropdown-item fantasy-dropdown-item"
            href="#"
            onclick="alert('You need the Explorers Compass to unlock Dungeons'); return false;"
          >
            <i class="fas fa-question-circle me-2"></i>Hidden
          </a>
        </li>
        {{end}}
        <li class="d-lg-none">
          <a class="dropdown-item fantasy-dropdown-item" href="/inventory">
            <i class="fas fa-treasure-chest me-2"></i>Inventory
          </a>
        </li>
        <li class="d-lg-none">
          <hr class="dropdown-divider fantasy-dropdown-divider" />
        </li>

        <!-- Regular dropdown items -->
        <li>
          <a class="dropdown-item fantasy-dropdown-item" href="/account">
            <i class="fas fa-user-cog me-2"></i>Account
          </a>
        </li>
        <li>
          <a
            class="dropdown-item fantasy-dropdown-item"
            href="#"
            onclick="alert('Support coming soon!'); return false;"
          >
            <i class="fab fa-discord me-2"></i>Support
          </a>
        </li>
        <li><hr class="dropdown-divider fantasy-dropdown-divider" /></li>
        <li>
          <form method="POST" action="/api/auth/logout" class="m-0">
            <button
              type="submit"
              class="dropdown-item fantasy-dropdown-item text-danger border-0 bg-transparent w-100 text-start"
            >
              <i class="fas fa-sign-out-alt me-2"></i>Sign Out
            </button>
          </form>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Initialize Bootstrap Popovers for locked nav items -->
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Initialize all popovers with custom styling
    const popoverTriggerList = [].slice.call(
      document.querySelectorAll('[data-bs-toggle="popover"]')
    );
    popoverTriggerList.map(function (popoverTriggerEl) {
      return new bootstrap.Popover(popoverTriggerEl, {
        trigger: "hover focus",
      });
    });
  });
</script>

{{end}}
